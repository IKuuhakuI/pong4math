<html lang="pt-br">
	<head>
		<link rel="shortcut icon" href="C:\Users\MAXX\Desktop\Trabalhos ORT\Técnico\PR\Site\favicon.ico">
		<meta charset="utf-8">
		
		<title>Pong4Math</title>
		
		<style>
			ul {
        		list-style-type: none;
        		margin: 0;
        		padding: 0;
        		overflow: hidden;
        		background-color: transparent;
        		margin-top: 10px;
        		margin-bottom: 10px;
        		float: right;
        		height: 53px;

      		}

      		li {
        		float: left;
        		margin-right: 5px;

      			}

      		li a {
       		 	display: block;
        		color: white;
        		text-align: center;
        		padding: 14px 16px;
        		text-decoration: none;
        		font-family: arial;
        		border-color: white;
        		border-style: solid; 
        		font-weight: bold;
        		border-radius: 500px;
        		background-color: black

      		}

      		li a:hover {
        		background-color: white;
        		color: black;
      		}

      		li a:active {
        		background-color: white;
        		border-color: white;
      		}

      		li a.active {
       	 		background-color: white;
        		color: black;
      		}
      		#campo {
			    border: white;
			    border-style: dotted;
				background-color: black;
				margin-top:  -300px;
				margin-left: -300px;
				position: absolute;
				left: 66.3%;
				top: 45%;
				z-index: 10;
			}

			#mycanvas {
			    border: white;
			    border-style: solid;
				background-color: ;
				margin-top: -300px;
				margin-left: -300px;
				position: absolute;
				left: 33%;
				top: 45%;
				z-index: 100;
			}

			#pong{
        		float: left;
        		width: 10px;
        		font-weight:bold;
        		border-style: none;
        		margin-left: 100px;
        		margin-top: 10px;
        		text-shadow: 1px 0px 0px white, -1px 0px 0px white, 0px 1px 0px white, 0px -1px 0px white;
        		font-size: 150%;
        		color: black;
        		font-family: arial;
      		}
		</style>
	</head>
	<body style="background-color: black">
		<!--Logo-->
		<h1><p id="pong"> Pong4Math </p></h1>

		<!--Menu-->
        <ul>
      		<li><a href="index.html">Home</a></li>
      		<li><a class="active" href="pong4math.html">Pong de 4</a></li>
    	</ul>

    	<!--Canvas principal-->
		<canvas id="mycanvas" height="720" width="1280">O seu browser não suporta este elemento</canvas>

		<!--Detalhes do campo-->
		<!--<canvas id="campo" height="720" width="3"></canvas>-->

		<script>
			//sounds
			 		//Som que toca quando um jogador acerta a bola
					var pongSound = new Audio();
					pongSound.src = "pongSound.mp3";

					//Som que toca quando um jogador ganha
					var winnerSound = new Audio();
					winnerSound.src = "winnerSound.mp3";

					//Som que toca qunado um jogador marca um ponto
					var scoreSound = new Audio();
					scoreSound.src = "scoreSound.mp3";

			//END SOUNDS

			//Constantes
			const SCORE = 10;

			//Aviso
		    alert("Jogador 1= W/A/S/D (cima e esquerda) Jogador 2 = Setas (baixo e direita)")
			var canvas = document.getElementById("mycanvas");
			var ctx = canvas.getContext("2d");

			var teclas = {};

			//Jogador esquerda
			var esquerda = {
				x: 10,
				y: canvas.height / 2 - 60,
				altura: 150,
				largura: 25,
				diry: 0,
				score: 0,
				speed: 5
			};

			//Jogador direita
			var direita = {
				x: canvas.width - 40,
				y: canvas.height / 2 - 60,
				altura: 150,
				largura: 25,
				diry: 0,
				score: 0,
				speed: 5
			};

			//Jogador de cima
			var cima = {
				x: canvas.width / 2 - 60,
				y: 10,
				altura: 25,
				largura: 150,
				diry: 0,
				
				speed: 5
			};

			//Jogador de baixo
			var baixo = {
				x: canvas.width / 2 - 60,
				y: canvas.height - 40,
				altura: 25,
				largura: 150,
				diry: 0,
				
				speed: 5
			};

			//Bola
			var bola = {
				x: canvas.width / 2 - 15,
				y: canvas.height / 2 - 15,
				altura: 25,
				largura: 25,
				dirx: -1,
				diry: 1,
				mod: 0,
				speed: 1
			};

			//Listeners
			document.addEventListener("keydown", function(e) {
				teclas[e.keyCode] = true;
				//alert(e.keyCode);
			}, false);
			
			document.addEventListener("keyup", function(e) {
				delete teclas[e.keyCode];
			}, false);
			//FIM Listerners

			//Funções
			//Função que move os jogadores
			function movebloco() {
				if(87 in teclas && esquerda.y > 0)
					esquerda.y -= esquerda.speed;

				else if(83 in teclas && esquerda.y + esquerda.altura < canvas.height)
					esquerda.y += esquerda.speed;

				if(65 in teclas && cima.x > 0)
					cima.x -= cima.speed;

				else if(68 in teclas && cima.x + cima.largura < canvas.width)
					cima.x += cima.speed;

				if(37 in teclas && baixo.x > 0)
					baixo.x -= baixo.speed;

				else if(39 in teclas && baixo.x + baixo.largura < canvas.width)
					baixo.x += baixo.speed;

				if(38 in teclas && direita.y > 0)
					direita.y -= direita.speed;

				else if(40 in teclas && direita.y + direita.altura < canvas.height)
					direita.y += direita.speed;
			};
			
			//Função que move a bola
			function movebola() {
				//esquerda
				if(bola.y + bola.altura >= esquerda.y && bola.y <= esquerda.y + (esquerda.altura * 1/8) && bola.x <= esquerda.x + esquerda.largura) {
					bola.dirx = 1;
					bola.diry = -3;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > esquerda.y + (esquerda.altura * 1/8) && bola.y <= esquerda.y + (esquerda.altura * 2/8) && bola.x <= esquerda.x + esquerda.largura) {
					bola.dirx = 1;
					bola.diry = -2;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > esquerda.y + (esquerda.altura * 2/8) && bola.y <= esquerda.y + (esquerda.altura * 3/8) && bola.x <= esquerda.x + esquerda.largura) {
					bola.dirx = 1;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > esquerda.y + (esquerda.altura * 3/8) && bola.y <= esquerda.y + (esquerda.altura * 5/8) && bola.x <= esquerda.x + esquerda.largura) {
					bola.dirx = 1;
					bola.diry = 0;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > esquerda.y + (esquerda.altura * 5/8) && bola.y <= esquerda.y + (esquerda.altura * 6/8) && bola.x <= esquerda.x + esquerda.largura) {
					bola.dirx = 1;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > esquerda.y + (esquerda.altura * 6/8) && bola.y <= esquerda.y + (esquerda.altura * 7/8) && bola.x <= esquerda.x + esquerda.largura) {
					bola.dirx = 1;
					bola.diry = 2;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > esquerda.y + (esquerda.altura * 7/8) && bola.y <= esquerda.y + esquerda.altura && bola.x <= esquerda.x + esquerda.largura) {
					bola.dirx = 1;
					bola.diry = 3;
					bola.mod += 0.1;
					pongSound.play();
				}

				//direita
				else if(bola.y + bola.altura >= direita.y && bola.y <= direita.y + (direita.altura * 1/8) && bola.x + bola.largura >= direita.x) {
					bola.dirx = -1;
					bola.diry = -3;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > direita.y + (direita.altura * 1/8) && bola.y <= direita.y + (direita.altura * 2/8) && bola.x + bola.largura >= direita.x) {
					bola.dirx = -1;
					bola.diry = -2;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > direita.y + (direita.altura * 2/8) && bola.y <= direita.y + (direita.altura * 3/8) && bola.x + bola.largura >= direita.x) {
					bola.dirx = -1;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > direita.y + (direita.altura * 3/8) && bola.y <= direita.y + (direita.altura * 5/8) && bola.x + bola.largura >= direita.x) {
					bola.dirx = -1;
					bola.diry = 0;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > direita.y + (direita.altura * 5/8) && bola.y <= direita.y + (direita.altura * 6/8) && bola.x + bola.largura >= direita.x) {
					bola.dirx = -1;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > direita.y + (direita.altura * 6/8) && bola.y <= direita.y + (direita.altura * 7/8) && bola.x + bola.largura >= direita.x) {
					bola.dirx = -1;
					bola.diry = 2;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.y + bola.altura > direita.y + (direita.altura * 7/8) && bola.y <= direita.y + direita.altura && bola.x + bola.largura >= direita.x) {
					bola.dirx = -1;
					bola.diry = 3;
					bola.mod += 0.1;
					pongSound.play();
				}

				//baixo
				if(bola.x + bola.largura >= baixo.x && bola.x <= baixo.x + (baixo.largura * 1/8) && bola.y + bola.altura>= baixo.y) {
					bola.dirx = -3;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > baixo.x + (baixo.largura * 1/8) && bola.x <= baixo.x + (baixo.largura * 2/8) && bola.y + bola.altura >= baixo.y) {
					bola.dirx = -2;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > baixo.x + (baixo.largura * 2/8) && bola.x <= baixo.x + (baixo.largura * 3/8) && bola.y + bola.altura >= baixo.y) {
					bola.dirx = -1;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > baixo.x + (baixo.largura * 3/8) && bola.x <= baixo.x + (baixo.largura * 5/8) && bola.y + bola.altura >= baixo.y) {
					bola.dirx = 0;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > baixo.x + (baixo.largura * 5/8) && bola.x <= baixo.x + (baixo.largura * 6/8) && bola.y + bola.altura >= baixo.y) {
					bola.dirx = 1;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > baixo.x + (baixo.largura * 6/8) && bola.x <= baixo.x + (baixo.largura * 7/8) && bola.y + bola.altura >= baixo.y) {
					bola.dirx = 2;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > baixo.x + (baixo.largura * 7/8) && bola.x <= baixo.x + baixo.largura && bola.y + bola.altura >= baixo.y) {
					bola.dirx = 3;
					bola.diry = -1;
					bola.mod += 0.1;
					pongSound.play();
				}

				//cima
				if(bola.x + bola.largura >= cima.x && bola.x <= cima.x + (cima.largura * 1/8) && bola.y <= cima.y + cima.altura) {
					bola.dirx = -3;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > cima.x + (cima.largura * 1/8) && bola.x <= cima.x + (cima.largura * 2/8) && bola.y <= cima.y + cima.altura) {
					bola.dirx = -2;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > cima.x + (cima.largura * 2/8) && bola.x <= cima.x + (cima.largura * 3/8) && bola.y <= cima.y + cima.altura) {
					bola.dirx = -1;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > cima.x + (cima.largura * 3/8) && bola.x <= cima.x + (cima.largura * 5/8) && bola.y <= cima.y + cima.altura) {
					bola.dirx = 0;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > cima.x + (cima.largura * 5/8) && bola.x <= cima.x + (cima.largura * 6/8) && bola.y <= cima.y + cima.altura) {
					bola.dirx = 1;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > cima.x + (cima.largura * 6/8) && bola.x <= cima.x + (cima.largura * 7/8) && bola.y <= cima.y + cima.altura) {
					bola.dirx = 2;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}

				else if(bola.x + bola.largura > cima.x + (cima.largura * 7/8) && bola.x <= cima.x + cima.largura && bola.y <= cima.y + cima.altura) {
					bola.dirx = 3;
					bola.diry = 1;
					bola.mod += 0.1;
					pongSound.play();
				}
				
				bola.x += (bola.speed + bola.mod) * bola.dirx;
				bola.y += (bola.speed + bola.mod) * bola.diry;

				if(bola.x < esquerda.x + esquerda.largura - 30 || bola.y <= 0)
					score("player 2");

				else if(bola.x + bola.largura > direita.x + 30 || bola.y + bola.altura > baixo.y + 30)
					score("player 1");
			};

			//Função que define quem marcou o ponto
			function score(winner) {
				if(winner == "player 1"){
					scoreSound.play();
					++esquerda.score;
				}
				else if(winner == "player 2"){
					scoreSound.play();
					++direita.score;
				}
				if (esquerda.score == SCORE){
					winnerSound.play();
					alert("Jogador 1 é o vencedor!");
					
					//Cria uma caixa de mensagem perguntando se os jogadores querem continuar 
					var continuarJogando = confirm("Deseja iniciar um novo jogo?");
					if (continuarJogando) {
  						window.location.reload();
					} else {
  						window.location.replace("index.html")
					}
				}
				if (direita.score == SCORE){
					winnerSound.play();
					alert("Jogador 2 é o vencedor!");
					
					//Cria uma caixa de mensagem perguntando se os jogadores querem continuar 
					var continuarJogando = confirm("Deseja iniciar um novo jogo?");
					if (continuarJogando) {
  						window.location.reload();
					} else {
  						window.location.href("index.html");
					}
				}

				esquerda.y = canvas.height / 2 - esquerda.altura / 2;
				direita.y = esquerda.y;
				cima.x = canvas.width / 2 - cima.largura/2;
				baixo.x = cima.x;
				bola.y = canvas.height / 2 - bola.altura / 2;
				bola.x = canvas.width / 2 - bola.largura / 2;
				bola.mod = 0;
				bola.speed = 1;
			};

			//Função que desenha os elementos no canvas
			function desenha() {

				ctx.clearRect(0, 0, canvas.width, canvas.height);

				movebloco();
				movebola();

				ctx.fillStyle = "white";

				ctx.fillRect(bola.x, bola.y, bola.largura, bola.altura);
				ctx.font = "100px Arial";
				ctx.fillText(esquerda.score, 320, 200);
				ctx.fillText(direita.score, canvas.width - 320, 200);
				

				//player 1
				ctx.fillRect(esquerda.x, esquerda.y, esquerda.largura, esquerda.altura);
				ctx.fillRect(cima.x, cima.y, cima.largura, cima.altura);


				//player 2
				ctx.fillStyle = "black";
				ctx.strokeStyle = "white";
				
				ctx.fillRect(direita.x, direita.y, direita.largura, direita.altura);
				ctx.strokeRect(direita.x, direita.y, direita.largura, direita.altura);

				ctx.fillRect(baixo.x, baixo.y, baixo.largura, baixo.altura);
				ctx.strokeRect(baixo.x, baixo.y, baixo.largura, baixo.altura);	

				//desenha detalhes
				ctx.fillStyle = "red";
				ctx.fillRect(canvas.width / 2 - 15, canvas.height, 30, 30);
			};

			//FIM FUNÇÕES
			//Tempo para redesenhar tudo
			setInterval(desenha, 1);
		</script>
	
	</body>
</html>